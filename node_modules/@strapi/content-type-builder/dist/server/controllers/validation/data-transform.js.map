{"version":3,"file":"data-transform.js","sources":["../../../../server/src/controllers/validation/data-transform.ts"],"sourcesContent":["import type { Struct } from '@strapi/types';\nimport _ from 'lodash';\nimport { hasDefaultAttribute } from '../../utils/typeguards';\n\nexport const removeEmptyDefaults = (\n  data: Partial<Struct.ContentTypeSchema> | Partial<Struct.ComponentSchema> | undefined\n) => {\n  const { attributes } = data || {};\n\n  Object.keys(attributes!).forEach((attributeName) => {\n    const attribute = attributes![attributeName];\n\n    if (hasDefaultAttribute(attribute) && attribute.default === '') {\n      attribute.default = undefined;\n    }\n  });\n};\n\nexport const removeDeletedUIDTargetFields = (data: Struct.ContentTypeSchema) => {\n  if (_.has(data, 'attributes')) {\n    Object.values(data.attributes).forEach((attribute) => {\n      if (\n        attribute.type === 'uid' &&\n        !_.isUndefined(attribute.targetField) &&\n        !_.has(data.attributes, attribute.targetField)\n      ) {\n        attribute.targetField = undefined;\n      }\n    });\n  }\n};\n"],"names":["removeEmptyDefaults","data","attributes","Object","keys","forEach","attributeName","attribute","hasDefaultAttribute","default","undefined","removeDeletedUIDTargetFields","_","has","values","type","isUndefined","targetField"],"mappings":";;;;;AAIO,MAAMA,sBAAsB,CACjCC,IAAAA,GAAAA;AAEA,IAAA,MAAM,EAAEC,UAAU,EAAE,GAAGD,QAAQ,EAAC;AAEhCE,IAAAA,MAAAA,CAAOC,IAAI,CAACF,UAAaG,CAAAA,CAAAA,OAAO,CAAC,CAACC,aAAAA,GAAAA;QAChC,MAAMC,SAAAA,GAAYL,UAAW,CAACI,aAAc,CAAA;AAE5C,QAAA,IAAIE,8BAAoBD,CAAAA,SAAAA,CAAAA,IAAcA,SAAUE,CAAAA,OAAO,KAAK,EAAI,EAAA;AAC9DF,YAAAA,SAAAA,CAAUE,OAAO,GAAGC,SAAAA;AACtB;AACF,KAAA,CAAA;AACF;AAEO,MAAMC,+BAA+B,CAACV,IAAAA,GAAAA;AAC3C,IAAA,IAAIW,CAAEC,CAAAA,GAAG,CAACZ,IAAAA,EAAM,YAAe,CAAA,EAAA;AAC7BE,QAAAA,MAAAA,CAAOW,MAAM,CAACb,IAAAA,CAAKC,UAAU,CAAEG,CAAAA,OAAO,CAAC,CAACE,SAAAA,GAAAA;YACtC,IACEA,SAAAA,CAAUQ,IAAI,KAAK,KAAA,IACnB,CAACH,CAAEI,CAAAA,WAAW,CAACT,SAAUU,CAAAA,WAAW,KACpC,CAACL,CAAAA,CAAEC,GAAG,CAACZ,IAAAA,CAAKC,UAAU,EAAEK,SAAAA,CAAUU,WAAW,CAC7C,EAAA;AACAV,gBAAAA,SAAAA,CAAUU,WAAW,GAAGP,SAAAA;AAC1B;AACF,SAAA,CAAA;AACF;AACF;;;;;"}