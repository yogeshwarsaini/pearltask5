{"version":3,"file":"getAttributesToDisplay.mjs","sources":["../../../../../admin/src/components/FormModal/utils/getAttributesToDisplay.ts"],"sourcesContent":["import { MAX_COMPONENT_DEPTH } from '../../../constants';\nimport { getComponentDepth } from '../../../utils/getMaxDepth';\n\nimport type { IconByType } from '../../AttributeIcon';\nimport type { NestedComponent } from '../../DataManager/utils/retrieveNestedComponents';\nimport type { Internal } from '@strapi/types';\n\nexport const getAttributesToDisplay = (\n  dataTarget = '',\n  targetUid: Internal.UID.Schema,\n  nestedComponents: Array<NestedComponent>\n): IconByType[][] => {\n  const defaultAttributes: IconByType[] = [\n    'text',\n    'boolean',\n    'blocks',\n    'json',\n    'number',\n    'email',\n    'date',\n    'password',\n    'media',\n    'enumeration',\n    'relation',\n    'richtext',\n  ];\n\n  const isPickingAttributeForAContentType = dataTarget === 'contentType';\n\n  if (isPickingAttributeForAContentType) {\n    return [\n      // Insert UID before the last item (richtext)\n      [...defaultAttributes.slice(0, -1), 'uid', ...defaultAttributes.slice(-1)],\n      ['component', 'dynamiczone'],\n    ];\n  }\n\n  // this will only run when adding attributes to components\n  if (dataTarget) {\n    const componentDepth = getComponentDepth(targetUid, nestedComponents);\n    const isNestedInAnotherComponent = componentDepth >= MAX_COMPONENT_DEPTH;\n    const canAddComponentInAnotherComponent =\n      !isPickingAttributeForAContentType && !isNestedInAnotherComponent;\n    if (canAddComponentInAnotherComponent) {\n      return [defaultAttributes, ['component']];\n    }\n  }\n\n  return [defaultAttributes];\n};\n"],"names":["getAttributesToDisplay","dataTarget","targetUid","nestedComponents","defaultAttributes","isPickingAttributeForAContentType","slice","componentDepth","getComponentDepth","isNestedInAnotherComponent","MAX_COMPONENT_DEPTH","canAddComponentInAnotherComponent"],"mappings":";;;MAOaA,sBAAyB,GAAA,CACpCC,UAAa,GAAA,EAAE,EACfC,SACAC,EAAAA,gBAAAA,GAAAA;AAEA,IAAA,MAAMC,iBAAkC,GAAA;AACtC,QAAA,MAAA;AACA,QAAA,SAAA;AACA,QAAA,QAAA;AACA,QAAA,MAAA;AACA,QAAA,QAAA;AACA,QAAA,OAAA;AACA,QAAA,MAAA;AACA,QAAA,UAAA;AACA,QAAA,OAAA;AACA,QAAA,aAAA;AACA,QAAA,UAAA;AACA,QAAA;AACD,KAAA;AAED,IAAA,MAAMC,oCAAoCJ,UAAe,KAAA,aAAA;AAEzD,IAAA,IAAII,iCAAmC,EAAA;QACrC,OAAO;;AAEL,YAAA;mBAAID,iBAAkBE,CAAAA,KAAK,CAAC,CAAA,EAAG,CAAC,CAAA,CAAA;AAAI,gBAAA,KAAA;mBAAUF,iBAAkBE,CAAAA,KAAK,CAAC,CAAC,CAAA;AAAG,aAAA;AAC1E,YAAA;AAAC,gBAAA,WAAA;AAAa,gBAAA;AAAc;AAC7B,SAAA;AACH;;AAGA,IAAA,IAAIL,UAAY,EAAA;QACd,MAAMM,cAAAA,GAAiBC,kBAAkBN,SAAWC,EAAAA,gBAAAA,CAAAA;AACpD,QAAA,MAAMM,6BAA6BF,cAAkBG,IAAAA,mBAAAA;QACrD,MAAMC,iCAAAA,GACJ,CAACN,iCAAAA,IAAqC,CAACI,0BAAAA;AACzC,QAAA,IAAIE,iCAAmC,EAAA;YACrC,OAAO;AAACP,gBAAAA,iBAAAA;AAAmB,gBAAA;AAAC,oBAAA;AAAY;AAAC,aAAA;AAC3C;AACF;IAEA,OAAO;AAACA,QAAAA;AAAkB,KAAA;AAC5B;;;;"}