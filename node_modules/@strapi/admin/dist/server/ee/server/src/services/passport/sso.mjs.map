{"version":3,"file":"sso.mjs","sources":["../../../../../../../ee/server/src/services/passport/sso.ts"],"sourcesContent":["import '@strapi/types';\nimport passport from '../../../../../server/src/services/passport';\nimport createProviderRegistry from './provider-registry';\n\nexport const providerRegistry = createProviderRegistry();\nconst errorMessage = 'SSO is disabled. Its functionnalities cannot be accessed.';\n\nexport const getStrategyCallbackURL = (providerName: string) => {\n  if (!strapi.ee.features.isEnabled('sso')) {\n    throw new Error(errorMessage);\n  }\n\n  return `/admin/connect/${providerName}`;\n};\n\nexport const syncProviderRegistryWithConfig = () => {\n  if (!strapi.ee.features.isEnabled('sso')) {\n    throw new Error(errorMessage);\n  }\n\n  const { providers = [] } = strapi.config.get('admin.auth', {}) as any;\n\n  // TODO\n  // @ts-expect-error check map types\n  providerRegistry.registerMany(providers);\n};\n\nexport const SSOAuthEventsMapper = {\n  onSSOAutoRegistration: 'admin.auth.autoRegistration',\n};\n\nexport default {\n  providerRegistry,\n  getStrategyCallbackURL,\n  syncProviderRegistryWithConfig,\n  authEventsMapper: { ...passport.authEventsMapper, ...SSOAuthEventsMapper },\n};\n"],"names":["providerRegistry","createProviderRegistry","errorMessage","getStrategyCallbackURL","providerName","strapi","ee","features","isEnabled","Error","syncProviderRegistryWithConfig","providers","config","get","registerMany","SSOAuthEventsMapper","onSSOAutoRegistration","authEventsMapper","passport"],"mappings":";;;;AAIO,MAAMA,mBAAmBC,sBAAyB;AACzD,MAAMC,YAAe,GAAA,2DAAA;AAEd,MAAMC,yBAAyB,CAACC,YAAAA,GAAAA;IACrC,IAAI,CAACC,OAAOC,EAAE,CAACC,QAAQ,CAACC,SAAS,CAAC,KAAQ,CAAA,EAAA;AACxC,QAAA,MAAM,IAAIC,KAAMP,CAAAA,YAAAA,CAAAA;AAClB;AAEA,IAAA,OAAO,CAAC,eAAe,EAAEE,YAAAA,CAAa,CAAC;AACzC;MAEaM,8BAAiC,GAAA,IAAA;IAC5C,IAAI,CAACL,OAAOC,EAAE,CAACC,QAAQ,CAACC,SAAS,CAAC,KAAQ,CAAA,EAAA;AACxC,QAAA,MAAM,IAAIC,KAAMP,CAAAA,YAAAA,CAAAA;AAClB;IAEA,MAAM,EAAES,SAAY,GAAA,EAAE,EAAE,GAAGN,MAAOO,CAAAA,MAAM,CAACC,GAAG,CAAC,YAAA,EAAc,EAAC,CAAA;;;AAI5Db,IAAAA,gBAAAA,CAAiBc,YAAY,CAACH,SAAAA,CAAAA;AAChC;MAEaI,mBAAsB,GAAA;IACjCC,qBAAuB,EAAA;AACzB;AAEA,UAAe;AACbhB,IAAAA,gBAAAA;AACAG,IAAAA,sBAAAA;AACAO,IAAAA,8BAAAA;IACAO,gBAAkB,EAAA;AAAE,QAAA,GAAGC,SAASD,gBAAgB;AAAE,QAAA,GAAGF;AAAoB;AAC3E,CAAE;;;;"}