{"version":3,"file":"TokenBox.js","sources":["../../../../../../../../admin/src/pages/Settings/components/Tokens/TokenBox.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { IconButton, Flex, Box, Typography, Button } from '@strapi/design-system';\nimport { Duplicate, Key } from '@strapi/icons';\nimport { useIntl } from 'react-intl';\nimport { styled } from 'styled-components';\n\nimport { ContentBox } from '../../../../components/ContentBox';\nimport { unstableUseGuidedTour } from '../../../../components/UnstableGuidedTour/Context';\nimport { tours as unstable_tours } from '../../../../components/UnstableGuidedTour/Tours';\nimport { useNotification } from '../../../../features/Notifications';\nimport { useTracking } from '../../../../features/Tracking';\nimport { useClipboard } from '../../../../hooks/useClipboard';\n\ninterface TokenBoxProps {\n  token?: string;\n  tokenType: 'transfer-token' | 'api-token';\n}\n\nconst TypographyWordBreak = styled(Typography)`\n  word-break: break-all;\n`;\n\nexport const UnstableApiTokenBox = ({ token, tokenType }: TokenBoxProps) => {\n  const { formatMessage } = useIntl();\n  const { toggleNotification } = useNotification();\n  const { trackUsage } = useTracking();\n  const dispatch = unstableUseGuidedTour('TokenBox', (s) => s.dispatch);\n\n  const { copy } = useClipboard();\n\n  const handleClick = (token: TokenBoxProps['token']) => async () => {\n    if (token) {\n      const didCopy = await copy(token);\n\n      if (didCopy) {\n        trackUsage('didCopyTokenKey', {\n          tokenType,\n        });\n        dispatch({\n          type: 'set_completed_actions',\n          payload: ['didCopyApiToken'],\n        });\n        toggleNotification({\n          type: 'success',\n          message: formatMessage({ id: 'Settings.tokens.notification.copied' }),\n        });\n      }\n    }\n  };\n\n  return (\n    <>\n      <Flex\n        shadow=\"tableShadow\"\n        direction=\"column\"\n        alignItems=\"start\"\n        hasRadius\n        padding={6}\n        background=\"neutral0\"\n      >\n        <Flex direction=\"column\" alignItems=\"start\" gap={1} paddingBottom={4}>\n          <Typography fontWeight=\"bold\">\n            {formatMessage({\n              id: 'Settings.tokens.copy.title',\n              defaultMessage: 'Token',\n            })}\n          </Typography>\n          <Typography>\n            {formatMessage({\n              id: 'Settings.tokens.copy.lastWarning',\n              defaultMessage: 'Make sure to copy this token, you won’t be able to see it again!',\n            })}\n          </Typography>\n        </Flex>\n        <Box background=\"neutral100\" hasRadius padding={2} borderColor=\"neutral150\">\n          <TypographyWordBreak fontWeight=\"semiBold\" variant=\"pi\">\n            {token}\n          </TypographyWordBreak>\n        </Box>\n        <unstable_tours.apiTokens.CopyAPIToken>\n          <Button\n            startIcon={<Duplicate />}\n            variant=\"secondary\"\n            onClick={handleClick(token)}\n            marginTop={6}\n          >\n            {formatMessage({ id: 'Settings.tokens.copy.copy', defaultMessage: 'Copy' })}\n          </Button>\n        </unstable_tours.apiTokens.CopyAPIToken>\n      </Flex>\n    </>\n  );\n};\n\nexport const TokenBox = ({ token, tokenType }: TokenBoxProps) => {\n  const { formatMessage } = useIntl();\n  const { toggleNotification } = useNotification();\n  const { trackUsage } = useTracking();\n\n  const { copy } = useClipboard();\n\n  const handleClick = (token: TokenBoxProps['token']) => async () => {\n    if (token) {\n      const didCopy = await copy(token);\n\n      if (didCopy) {\n        trackUsage('didCopyTokenKey', {\n          tokenType,\n        });\n        toggleNotification({\n          type: 'success',\n          message: formatMessage({ id: 'Settings.tokens.notification.copied' }),\n        });\n      }\n    }\n  };\n\n  return (\n    <ContentBox\n      endAction={\n        token && (\n          <span style={{ alignSelf: 'start' }}>\n            <IconButton\n              label={formatMessage({\n                id: 'app.component.CopyToClipboard.label',\n                defaultMessage: 'Copy to clipboard',\n              })}\n              onClick={handleClick(token)}\n              variant=\"ghost\"\n              type=\"button\"\n              style={{ padding: 0, height: '1.6rem' }}\n            >\n              <Duplicate />\n            </IconButton>\n          </span>\n        )\n      }\n      title={\n        token ||\n        formatMessage({\n          id: 'Settings.tokens.copy.editTitle',\n          defaultMessage: 'This token isn’t accessible anymore.',\n        })\n      }\n      subtitle={\n        token\n          ? formatMessage(\n              tokenType === 'api-token'\n                ? {\n                    id: 'Settings.tokens.copy.subtitle',\n                    defaultMessage: 'Copy this token for use elsewhere',\n                  }\n                : {\n                    id: 'Settings.tokens.copy.lastWarning',\n                    defaultMessage:\n                      'Make sure to copy this token, you won’t be able to see it again!',\n                  }\n            )\n          : formatMessage({\n              id: 'Settings.tokens.copy.editMessage',\n              defaultMessage: 'For security reasons, you can only see your token once.',\n            })\n      }\n      icon={<Key />}\n      iconBackground=\"neutral100\"\n    />\n  );\n};\n"],"names":["TypographyWordBreak","styled","Typography","UnstableApiTokenBox","token","tokenType","formatMessage","useIntl","toggleNotification","useNotification","trackUsage","useTracking","dispatch","unstableUseGuidedTour","s","copy","useClipboard","handleClick","didCopy","type","payload","message","id","_jsx","_Fragment","_jsxs","Flex","shadow","direction","alignItems","hasRadius","padding","background","gap","paddingBottom","fontWeight","defaultMessage","Box","borderColor","variant","unstable_tours","apiTokens","CopyAPIToken","Button","startIcon","Duplicate","onClick","marginTop","TokenBox","ContentBox","endAction","span","style","alignSelf","IconButton","label","height","title","subtitle","icon","Key","iconBackground"],"mappings":"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"}