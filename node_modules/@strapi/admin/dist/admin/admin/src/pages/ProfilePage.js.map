{"version":3,"file":"ProfilePage.js","sources":["../../../../../admin/src/pages/ProfilePage.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { Box, Button, Flex, useNotifyAT, Grid, Typography } from '@strapi/design-system';\nimport { Check } from '@strapi/icons';\nimport upperFirst from 'lodash/upperFirst';\nimport { useIntl } from 'react-intl';\nimport * as yup from 'yup';\n\nimport { Form, FormHelpers } from '../components/Form';\nimport { InputRenderer } from '../components/FormInputs/Renderer';\nimport { Layouts } from '../components/Layouts/Layout';\nimport { Page } from '../components/PageHelpers';\nimport { useTypedDispatch, useTypedSelector } from '../core/store/hooks';\nimport { useAuth } from '../features/Auth';\nimport { useNotification } from '../features/Notifications';\nimport { useTracking } from '../features/Tracking';\nimport { useAPIErrorHandler } from '../hooks/useAPIErrorHandler';\nimport { AppState, setAppTheme } from '../reducer';\nimport { useIsSSOLockedQuery, useUpdateMeMutation } from '../services/auth';\nimport { isBaseQueryError } from '../utils/baseQuery';\nimport { translatedErrors } from '../utils/translatedErrors';\nimport { getDisplayName } from '../utils/users';\n\nimport { COMMON_USER_SCHEMA } from './Settings/pages/Users/utils/validation';\n\nimport type { UpdateMe } from '../../../shared/contracts/users';\n\nconst PROFILE_VALIDTION_SCHEMA = yup.object().shape({\n  ...COMMON_USER_SCHEMA,\n  currentPassword: yup\n    .string()\n    // @ts-expect-error â€“ no idea why this is failing.\n    .when(['password', 'confirmPassword'], (password, confirmPassword, passSchema) => {\n      return password || confirmPassword\n        ? passSchema\n            .required({\n              id: translatedErrors.required.id,\n              defaultMessage: 'This field is required',\n            })\n            .nullable()\n        : passSchema;\n    }),\n  preferedLanguage: yup.string().nullable(),\n});\n\n/* -------------------------------------------------------------------------------------------------\n * ProfilePage\n * -----------------------------------------------------------------------------------------------*/\n\nconst ProfilePage = () => {\n  const localeNames = useTypedSelector((state) => state.admin_app.language.localeNames);\n  const { formatMessage } = useIntl();\n  const { trackUsage } = useTracking();\n  const { toggleNotification } = useNotification();\n  const { notifyStatus } = useNotifyAT();\n  const currentTheme = useTypedSelector((state) => state.admin_app.theme.currentTheme);\n  const dispatch = useTypedDispatch();\n  const {\n    _unstableFormatValidationErrors: formatValidationErrors,\n    _unstableFormatAPIError: formatApiError,\n  } = useAPIErrorHandler();\n\n  const user = useAuth('ProfilePage', (state) => state.user);\n\n  React.useEffect(() => {\n    if (user) {\n      notifyStatus(\n        formatMessage({\n          id: 'Settings.profile.form.notify.data.loaded',\n          defaultMessage: 'Your profile data has been loaded',\n        })\n      );\n    } else {\n      toggleNotification({\n        type: 'danger',\n        message: formatMessage({ id: 'notification.error', defaultMessage: 'An error occured' }),\n      });\n    }\n  }, [formatMessage, notifyStatus, toggleNotification, user]);\n\n  const [updateMe, { isLoading: isSubmittingForm }] = useUpdateMeMutation();\n\n  const {\n    isLoading,\n    data: dataSSO,\n    error,\n  } = useIsSSOLockedQuery(undefined, {\n    skip: !(window.strapi.isEE && window.strapi.features.isEnabled('sso')),\n  });\n\n  React.useEffect(() => {\n    if (error) {\n      toggleNotification({\n        type: 'danger',\n        message: formatMessage({ id: 'Settings.permissions.users.sso.provider.error' }),\n      });\n    }\n  }, [error, formatMessage, toggleNotification]);\n\n  type UpdateUsersMeBody = UpdateMe.Request['body'] & {\n    confirmPassword: string;\n    currentTheme: AppState['theme']['currentTheme'];\n  };\n\n  const handleSubmit = async (\n    body: UpdateUsersMeBody,\n    { setErrors }: FormHelpers<UpdateUsersMeBody>\n  ) => {\n    const { confirmPassword: _confirmPassword, currentTheme, ...bodyRest } = body;\n    let dataToSend = bodyRest;\n\n    // The password fields are optional. If the user didn't touch them, don't send any password\n    // to the API, because an empty string would throw a validation error\n    if (dataToSend.password === '') {\n      const {\n        password: _password,\n        currentPassword: _currentPassword,\n        ...passwordRequestBodyRest\n      } = dataToSend;\n      dataToSend = passwordRequestBodyRest;\n    }\n\n    const res = await updateMe(dataToSend);\n\n    if ('data' in res) {\n      dispatch(setAppTheme(currentTheme));\n\n      trackUsage('didChangeMode', { newMode: currentTheme });\n\n      toggleNotification({\n        type: 'success',\n        message: formatMessage({ id: 'notification.success.saved', defaultMessage: 'Saved' }),\n      });\n    }\n\n    if ('error' in res) {\n      if (isBaseQueryError(res.error) && res.error.name === 'ValidationError') {\n        setErrors(formatValidationErrors(res.error));\n      } else if (isBaseQueryError(res.error)) {\n        toggleNotification({\n          type: 'danger',\n          message: formatApiError(res.error),\n        });\n      } else {\n        toggleNotification({\n          type: 'danger',\n          message: formatMessage({ id: 'notification.error', defaultMessage: 'An error occured' }),\n        });\n      }\n    }\n  };\n\n  if (isLoading) {\n    return <Page.Loading />;\n  }\n\n  const hasLockedRole = dataSSO?.isSSOLocked ?? false;\n  const { email, firstname, lastname, username, preferedLanguage } = user ?? {};\n  const initialData = {\n    email: email ?? '',\n    firstname: firstname ?? '',\n    lastname: lastname ?? '',\n    username: username ?? '',\n    preferedLanguage,\n    currentTheme,\n    confirmPassword: '',\n    password: '',\n  };\n\n  return (\n    <Page.Main aria-busy={isSubmittingForm}>\n      <Page.Title>\n        {formatMessage({\n          id: 'Settings.profile.form.section.head.title',\n          defaultMessage: 'User profile',\n        })}\n      </Page.Title>\n      <Form\n        method=\"PUT\"\n        onSubmit={handleSubmit}\n        initialValues={initialData}\n        validationSchema={PROFILE_VALIDTION_SCHEMA}\n      >\n        {({ isSubmitting, modified }) => (\n          <>\n            <Layouts.Header\n              title={getDisplayName(user)}\n              primaryAction={\n                <Button\n                  startIcon={<Check />}\n                  loading={isSubmitting}\n                  type=\"submit\"\n                  disabled={!modified}\n                >\n                  {formatMessage({ id: 'global.save', defaultMessage: 'Save' })}\n                </Button>\n              }\n            />\n            <Box paddingBottom={10}>\n              <Layouts.Content>\n                <Flex direction=\"column\" alignItems=\"stretch\" gap={6}>\n                  <UserInfoSection />\n                  {!hasLockedRole && <PasswordSection />}\n                  <PreferencesSection localeNames={localeNames} />\n                </Flex>\n              </Layouts.Content>\n            </Box>\n          </>\n        )}\n      </Form>\n    </Page.Main>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * PasswordSection\n * -----------------------------------------------------------------------------------------------*/\n\nconst PasswordSection = () => {\n  const { formatMessage } = useIntl();\n\n  return (\n    <Box\n      background=\"neutral0\"\n      hasRadius\n      shadow=\"filterShadow\"\n      paddingTop={6}\n      paddingBottom={6}\n      paddingLeft={7}\n      paddingRight={7}\n    >\n      <Flex direction=\"column\" alignItems=\"stretch\" gap={4}>\n        <Typography variant=\"delta\" tag=\"h2\">\n          {formatMessage({\n            id: 'global.change-password',\n            defaultMessage: 'Change password',\n          })}\n        </Typography>\n        {[\n          [\n            {\n              label: formatMessage({\n                id: 'Auth.form.currentPassword.label',\n                defaultMessage: 'Current Password',\n              }),\n              name: 'currentPassword',\n              size: 6,\n              type: 'password' as const,\n            },\n          ],\n          [\n            {\n              autoComplete: 'new-password',\n              label: formatMessage({\n                id: 'global.password',\n                defaultMessage: 'Password',\n              }),\n              name: 'password',\n              size: 6,\n              type: 'password' as const,\n            },\n            {\n              autoComplete: 'new-password',\n              label: formatMessage({\n                id: 'Auth.form.confirmPassword.label',\n                defaultMessage: 'Confirm Password',\n              }),\n              name: 'confirmPassword',\n              size: 6,\n              type: 'password' as const,\n            },\n          ],\n        ].map((row, index) => (\n          <Grid.Root key={index} gap={5}>\n            {row.map(({ size, ...field }) => (\n              <Grid.Item key={field.name} col={size} direction=\"column\" alignItems=\"stretch\">\n                <InputRenderer {...field} />\n              </Grid.Item>\n            ))}\n          </Grid.Root>\n        ))}\n      </Flex>\n    </Box>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * PreferencesSection\n * -----------------------------------------------------------------------------------------------*/\n\ninterface PreferencesSectionProps {\n  localeNames: Record<string, string>;\n}\n\nconst PreferencesSection = ({ localeNames }: PreferencesSectionProps) => {\n  const { formatMessage } = useIntl();\n  const themesToDisplay = useTypedSelector((state) => state.admin_app.theme.availableThemes);\n\n  return (\n    <Box\n      background=\"neutral0\"\n      hasRadius\n      shadow=\"filterShadow\"\n      paddingTop={6}\n      paddingBottom={6}\n      paddingLeft={7}\n      paddingRight={7}\n    >\n      <Flex direction=\"column\" alignItems=\"stretch\" gap={4}>\n        <Flex direction=\"column\" alignItems=\"stretch\" gap={1}>\n          <Typography variant=\"delta\" tag=\"h2\">\n            {formatMessage({\n              id: 'Settings.profile.form.section.experience.title',\n              defaultMessage: 'Experience',\n            })}\n          </Typography>\n          <Typography>\n            {formatMessage(\n              {\n                id: 'Settings.profile.form.section.experience.interfaceLanguageHelp',\n                defaultMessage:\n                  'Preference changes will apply only to you. More information is available {here}.',\n              },\n              {\n                here: (\n                  <Box\n                    tag=\"a\"\n                    color=\"primary600\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    href=\"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales\"\n                  >\n                    {formatMessage({\n                      id: 'Settings.profile.form.section.experience.here',\n                      defaultMessage: 'here',\n                    })}\n                  </Box>\n                ),\n              }\n            )}\n          </Typography>\n        </Flex>\n        <Grid.Root gap={5}>\n          {[\n            {\n              hint: formatMessage({\n                id: 'Settings.profile.form.section.experience.interfaceLanguage.hint',\n                defaultMessage: 'This will only display your own interface in the chosen language.',\n              }),\n              label: formatMessage({\n                id: 'Settings.profile.form.section.experience.interfaceLanguage',\n                defaultMessage: 'Interface language',\n              }),\n              name: 'preferedLanguage',\n              options: Object.entries(localeNames).map(([value, label]) => ({\n                label,\n                value,\n              })),\n              placeholder: formatMessage({\n                id: 'global.select',\n                defaultMessage: 'Select',\n              }),\n              size: 6,\n              type: 'enumeration' as const,\n            },\n            {\n              hint: formatMessage({\n                id: 'Settings.profile.form.section.experience.mode.hint',\n                defaultMessage: 'Displays your interface in the chosen mode.',\n              }),\n              label: formatMessage({\n                id: 'Settings.profile.form.section.experience.mode.label',\n                defaultMessage: 'Interface mode',\n              }),\n              name: 'currentTheme',\n              options: [\n                {\n                  label: formatMessage({\n                    id: 'Settings.profile.form.section.experience.mode.option-system-label',\n                    defaultMessage: 'Use system settings',\n                  }),\n                  value: 'system',\n                },\n                ...themesToDisplay.map((theme) => ({\n                  label: formatMessage(\n                    {\n                      id: 'Settings.profile.form.section.experience.mode.option-label',\n                      defaultMessage: '{name} mode',\n                    },\n                    {\n                      name: formatMessage({\n                        id: theme,\n                        defaultMessage: upperFirst(theme),\n                      }),\n                    }\n                  ),\n                  value: theme,\n                })),\n              ],\n              placeholder: formatMessage({\n                id: 'components.Select.placeholder',\n                defaultMessage: 'Select',\n              }),\n              size: 6,\n              type: 'enumeration' as const,\n            },\n          ].map(({ size, ...field }) => (\n            <Grid.Item key={field.name} col={size} direction=\"column\" alignItems=\"stretch\">\n              <InputRenderer {...field} />\n            </Grid.Item>\n          ))}\n        </Grid.Root>\n      </Flex>\n    </Box>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * UserInfoSection\n * -----------------------------------------------------------------------------------------------*/\n\nconst UserInfoSection = () => {\n  const { formatMessage } = useIntl();\n\n  return (\n    <Box\n      background=\"neutral0\"\n      hasRadius\n      shadow=\"filterShadow\"\n      paddingTop={6}\n      paddingBottom={6}\n      paddingLeft={7}\n      paddingRight={7}\n    >\n      <Flex direction=\"column\" alignItems=\"stretch\" gap={4}>\n        <Typography variant=\"delta\" tag=\"h2\">\n          {formatMessage({\n            id: 'global.profile',\n            defaultMessage: 'Profile',\n          })}\n        </Typography>\n        <Grid.Root gap={5}>\n          {[\n            {\n              label: formatMessage({\n                id: 'Auth.form.firstname.label',\n                defaultMessage: 'First name',\n              }),\n              name: 'firstname',\n              required: true,\n              size: 6,\n              type: 'string' as const,\n            },\n            {\n              label: formatMessage({\n                id: 'Auth.form.lastname.label',\n                defaultMessage: 'Last name',\n              }),\n              name: 'lastname',\n              size: 6,\n              type: 'string' as const,\n            },\n            {\n              label: formatMessage({\n                id: 'Auth.form.email.label',\n                defaultMessage: 'Email',\n              }),\n              name: 'email',\n              required: true,\n              size: 6,\n              type: 'email' as const,\n            },\n            {\n              label: formatMessage({\n                id: 'Auth.form.username.label',\n                defaultMessage: 'Username',\n              }),\n              name: 'username',\n              size: 6,\n              type: 'string' as const,\n            },\n          ].map(({ size, ...field }) => (\n            <Grid.Item key={field.name} col={size} direction=\"column\" alignItems=\"stretch\">\n              <InputRenderer {...field} />\n            </Grid.Item>\n          ))}\n        </Grid.Root>\n      </Flex>\n    </Box>\n  );\n};\n\nexport { ProfilePage };\n"],"names":["PROFILE_VALIDTION_SCHEMA","yup","object","shape","COMMON_USER_SCHEMA","currentPassword","string","when","password","confirmPassword","passSchema","required","id","translatedErrors","defaultMessage","nullable","preferedLanguage","ProfilePage","localeNames","useTypedSelector","state","admin_app","language","formatMessage","useIntl","trackUsage","useTracking","toggleNotification","useNotification","notifyStatus","useNotifyAT","currentTheme","theme","dispatch","useTypedDispatch","_unstableFormatValidationErrors","formatValidationErrors","_unstableFormatAPIError","formatApiError","useAPIErrorHandler","user","useAuth","React","useEffect","type","message","updateMe","isLoading","isSubmittingForm","useUpdateMeMutation","data","dataSSO","error","useIsSSOLockedQuery","undefined","skip","window","strapi","isEE","features","isEnabled","handleSubmit","body","setErrors","_confirmPassword","bodyRest","dataToSend","_password","_currentPassword","passwordRequestBodyRest","res","setAppTheme","newMode","isBaseQueryError","name","_jsx","Page","Loading","hasLockedRole","isSSOLocked","email","firstname","lastname","username","initialData","_jsxs","Main","aria-busy","Title","Form","method","onSubmit","initialValues","validationSchema","isSubmitting","modified","_Fragment","Layouts","Header","title","getDisplayName","primaryAction","Button","startIcon","Check","loading","disabled","Box","paddingBottom","Content","Flex","direction","alignItems","gap","UserInfoSection","PasswordSection","PreferencesSection","background","hasRadius","shadow","paddingTop","paddingLeft","paddingRight","Typography","variant","tag","label","size","autoComplete","map","row","index","Grid","Root","field","Item","col","InputRenderer","themesToDisplay","availableThemes","here","color","target","rel","href","hint","options","Object","entries","value","placeholder","upperFirst"],"mappings":"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"}