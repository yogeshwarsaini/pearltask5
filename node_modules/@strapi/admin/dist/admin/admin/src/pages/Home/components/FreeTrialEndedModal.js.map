{"version":3,"file":"FreeTrialEndedModal.js","sources":["../../../../../../../admin/src/pages/Home/components/FreeTrialEndedModal.tsx"],"sourcesContent":["import { useState } from 'react';\n\nimport { Box, Button, Flex, LinkButton, Modal, Typography } from '@strapi/design-system';\nimport { Cross } from '@strapi/icons';\nimport { isAfter, subDays } from 'date-fns';\nimport { useIntl } from 'react-intl';\nimport styled from 'styled-components';\n\nimport { useLicenseLimits } from '../../../../../ee/admin/src/hooks/useLicenseLimits';\nimport { usePersistentState } from '../../../hooks/usePersistentState';\n\nconst StyledModalContent = styled(Modal.Content)`\n  max-width: 51.6rem;\n`;\n\nconst StyledModalBody = styled(Modal.Body)`\n  padding: 0;\n  position: relative;\n\n  > div {\n    padding: 0;\n  }\n`;\n\nconst StyledButton = styled(Button)`\n  border: 0;\n  border-radius: 50%;\n`;\n\nexport const FreeTrialEndedModal = () => {\n  const { formatMessage } = useIntl();\n  const [open, setOpen] = useState(true);\n  const [previouslyOpen, setPreviouslyOpen] = usePersistentState(\n    'STRAPI_FREE_TRIAL_ENDED_MODAL',\n    false\n  );\n  const [cachedTrialEndsAt] = usePersistentState<string | undefined>(\n    'STRAPI_FREE_TRIAL_ENDS_AT',\n    undefined\n  );\n\n  const { license } = useLicenseLimits();\n\n  const sevenDaysAgo = subDays(new Date(), 7);\n\n  // When the license is not a trial + not EE, and the cached trial end date is found in the localstorage, that means the trial has ended\n  // We show the banner to encourage the user to upgrade (for 7 days after the trial ends)\n  const isTrialEndedRecently = Boolean(\n    !license?.isTrial &&\n      !window.strapi.isEE &&\n      cachedTrialEndsAt &&\n      isAfter(new Date(cachedTrialEndsAt), sevenDaysAgo)\n  );\n\n  const handleClose = () => {\n    setPreviouslyOpen(true);\n    setOpen(false);\n  };\n\n  const handleOnOpenChange = (isOpen: boolean) => {\n    if (!isOpen) {\n      setPreviouslyOpen(true);\n    }\n\n    setOpen(isOpen);\n  };\n\n  if (!previouslyOpen && isTrialEndedRecently) {\n    return (\n      <Modal.Root open={open} onOpenChange={handleOnOpenChange}>\n        <StyledModalContent aria-labelledby=\"title\">\n          <StyledModalBody>\n            <Box position=\"absolute\" top={0} right={0} padding={2}>\n              <StyledButton\n                aria-label={formatMessage({\n                  id: 'app.utils.close-label',\n                  defaultMessage: 'Close',\n                })}\n                variant=\"ghost\"\n                width=\"2.4rem\"\n                height=\"2.4rem\"\n                onClick={handleClose}\n              >\n                <Cross />\n              </StyledButton>\n            </Box>\n            <Flex\n              direction=\"column\"\n              alignItems=\"start\"\n              justifyContent=\"stretch\"\n              padding={8}\n              gap={4}\n            >\n              <Typography variant=\"alpha\" fontWeight=\"bold\" fontSize={4} id=\"title\">\n                {formatMessage({\n                  id: 'app.components.FreeTrialEndedModal.title',\n                  defaultMessage: 'Your trial has ended',\n                })}\n              </Typography>\n              <Typography>\n                {formatMessage({\n                  id: 'app.components.FreeTrialEndedModal.description',\n                  defaultMessage:\n                    'Your access to Growth plan features such as Content history, Releases and Single sign-On (SSO) has expired.',\n                })}\n              </Typography>\n              <Box background=\"primary200\" padding={4} hasRadius>\n                <Typography fontWeight=\"bold\">\n                  {formatMessage({\n                    id: 'app.components.FreeTrialEndedModal.notice.title',\n                    defaultMessage: 'Important to know:',\n                  })}\n                </Typography>\n                <ul style={{ listStyleType: 'disc', marginLeft: '1.5rem' }}>\n                  <li>\n                    <Typography>\n                      {formatMessage({\n                        id: 'app.components.FreeTrialEndedModal.notice.item1',\n                        defaultMessage: 'Downgrading will remove access to the above features.',\n                      })}\n                    </Typography>\n                  </li>\n                  <li>\n                    <Typography>\n                      {formatMessage({\n                        id: 'app.components.FreeTrialEndedModal.notice.item2',\n                        defaultMessage: 'Document version history will be deleted.',\n                      })}\n                    </Typography>\n                  </li>\n                  <li>\n                    <Typography>\n                      {formatMessage({\n                        id: 'app.components.FreeTrialEndedModal.notice.item3',\n                        defaultMessage: 'All releases will be erased.',\n                      })}\n                    </Typography>\n                  </li>\n                  <li>\n                    <Typography>\n                      {formatMessage({\n                        id: 'app.components.FreeTrialEndedModal.notice.item4',\n                        defaultMessage:\n                          'If you downgrade ensure to set a root admin password to keep access to the admin panel.',\n                      })}\n                    </Typography>\n                  </li>\n                </ul>\n              </Box>\n              <Flex marginTop={4} gap={2}>\n                <LinkButton href=\"https://strapi.chargebeeportal.com/\" target=\"_blank\">\n                  {formatMessage({\n                    id: 'app.components.FreeTrialEndedModal.button.upgrade',\n                    defaultMessage: 'Stay on the Growth plan',\n                  })}\n                </LinkButton>\n                <Button variant=\"tertiary\" onClick={handleClose}>\n                  {formatMessage({\n                    id: 'app.components.FreeTrialEndedModal.button.downgrade',\n                    defaultMessage: 'Downgrade to Community',\n                  })}\n                </Button>\n              </Flex>\n            </Flex>\n          </StyledModalBody>\n        </StyledModalContent>\n      </Modal.Root>\n    );\n  }\n\n  return null;\n};\n"],"names":["StyledModalContent","styled","Modal","Content","StyledModalBody","Body","StyledButton","Button","FreeTrialEndedModal","formatMessage","useIntl","open","setOpen","useState","previouslyOpen","setPreviouslyOpen","usePersistentState","cachedTrialEndsAt","undefined","license","useLicenseLimits","sevenDaysAgo","subDays","Date","isTrialEndedRecently","Boolean","isTrial","window","strapi","isEE","isAfter","handleClose","handleOnOpenChange","isOpen","_jsx","Root","onOpenChange","aria-labelledby","_jsxs","Box","position","top","right","padding","aria-label","id","defaultMessage","variant","width","height","onClick","Cross","Flex","direction","alignItems","justifyContent","gap","Typography","fontWeight","fontSize","background","hasRadius","ul","style","listStyleType","marginLeft","li","marginTop","LinkButton","href","target"],"mappings":"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"}