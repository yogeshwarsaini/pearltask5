{"version":3,"file":"AdminSeatInfo.js","sources":["../../../../../../../../../../ee/admin/src/pages/SettingsPage/pages/ApplicationInfoPage/components/AdminSeatInfo.tsx"],"sourcesContent":["import { Flex, Tooltip, Typography, Link, Grid } from '@strapi/design-system';\nimport { ExternalLink, WarningCircle } from '@strapi/icons';\nimport { useIntl } from 'react-intl';\nimport { useSelector } from 'react-redux';\n\nimport { useRBAC } from '../../../../../../../../admin/src/hooks/useRBAC';\nimport { selectAdminPermissions } from '../../../../../../../../admin/src/selectors';\nimport { useLicenseLimits } from '../../../../../hooks/useLicenseLimits';\n\nconst BILLING_SELF_HOSTED_URL = 'https://strapi.io/billing/request-seats';\nconst MANAGE_SEATS_URL = 'https://strapi.io/billing/manage-seats';\n\nexport const AdminSeatInfoEE = () => {\n  const { formatMessage } = useIntl();\n  const { settings } = useSelector(selectAdminPermissions);\n  const {\n    isLoading: isRBACLoading,\n    allowedActions: { canRead, canCreate, canUpdate, canDelete },\n  } = useRBAC(settings?.users ?? {});\n  const {\n    license,\n    isError,\n    isLoading: isLicenseLoading,\n  } = useLicenseLimits({\n    // TODO: this creates a waterfall which we should avoid to render earlier, but for that\n    // we will have to move away from data-fetching hooks to query functions.\n    // Short-term we could at least implement a loader, for the user to have visual feedback\n    // in case the requests take a while\n    enabled: !isRBACLoading && canRead && canCreate && canUpdate && canDelete,\n  });\n\n  const isLoading = isRBACLoading || isLicenseLoading;\n\n  if (isError || isLoading || !license) {\n    return null;\n  }\n\n  const { licenseLimitStatus, enforcementUserCount, permittedSeats, type } = license;\n\n  if (!permittedSeats) {\n    return null;\n  }\n\n  return (\n    <Grid.Item col={6} s={12} direction=\"column\" alignItems=\"stretch\">\n      <Typography variant=\"sigma\" textColor=\"neutral600\">\n        {formatMessage({\n          id: 'Settings.application.admin-seats',\n          defaultMessage: 'Admin seats',\n        })}\n      </Typography>\n      <Flex gap={2}>\n        <Flex>\n          <Typography tag=\"p\">\n            {formatMessage(\n              {\n                id: 'Settings.application.ee.admin-seats.count',\n                defaultMessage: '<text>{enforcementUserCount}</text>/{permittedSeats}',\n              },\n              {\n                permittedSeats,\n                enforcementUserCount,\n                text: (chunks) =>\n                  (\n                    <Typography\n                      fontWeight=\"semiBold\"\n                      textColor={enforcementUserCount > permittedSeats ? 'danger500' : undefined}\n                    >\n                      {chunks}\n                    </Typography>\n                  ) as any,\n              }\n            )}\n          </Typography>\n        </Flex>\n        {licenseLimitStatus === 'OVER_LIMIT' && (\n          <Tooltip\n            label={formatMessage({\n              id: 'Settings.application.ee.admin-seats.at-limit-tooltip',\n              defaultMessage: 'At limit: add seats to invite more users',\n            })}\n          >\n            <WarningCircle width=\"1.4rem\" height=\"1.4rem\" fill=\"danger500\" />\n          </Tooltip>\n        )}\n      </Flex>\n      {type === 'gold' ? (\n        <Link href={BILLING_SELF_HOSTED_URL} endIcon={<ExternalLink />}>\n          {formatMessage({\n            id: 'Settings.application.ee.admin-seats.support',\n            defaultMessage: 'Contact sales',\n          })}\n        </Link>\n      ) : (\n        <Link href={MANAGE_SEATS_URL} isExternal endIcon={<ExternalLink />}>\n          {formatMessage({\n            id: 'Settings.application.ee.admin-seats.add-seats',\n            defaultMessage: 'Manage seats',\n          })}\n        </Link>\n      )}\n    </Grid.Item>\n  );\n};\n"],"names":["BILLING_SELF_HOSTED_URL","MANAGE_SEATS_URL","AdminSeatInfoEE","formatMessage","useIntl","settings","useSelector","selectAdminPermissions","isLoading","isRBACLoading","allowedActions","canRead","canCreate","canUpdate","canDelete","useRBAC","users","license","isError","isLicenseLoading","useLicenseLimits","enabled","licenseLimitStatus","enforcementUserCount","permittedSeats","type","_jsxs","Grid","Item","col","s","direction","alignItems","_jsx","Typography","variant","textColor","id","defaultMessage","Flex","gap","tag","text","chunks","fontWeight","undefined","Tooltip","label","WarningCircle","width","height","fill","Link","href","endIcon","ExternalLink","isExternal"],"mappings":"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"}