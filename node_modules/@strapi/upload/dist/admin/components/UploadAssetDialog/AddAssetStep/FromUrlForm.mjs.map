{"version":3,"file":"FromUrlForm.mjs","sources":["../../../../../admin/src/components/UploadAssetDialog/AddAssetStep/FromUrlForm.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { useTracking } from '@strapi/admin/strapi-admin';\nimport { Box, Button, Field, Modal, Textarea } from '@strapi/design-system';\nimport { Form, Formik } from 'formik';\nimport { useIntl } from 'react-intl';\n\nimport { getTrad, urlsToAssets, urlSchema } from '../../../utils';\n\nimport type { FileWithRawFile } from './AddAssetStep';\n\ninterface FromUrlFormProps {\n  onClose: () => void;\n  onAddAsset: (assets: FileWithRawFile[]) => void;\n  trackedLocation?: string;\n}\n\nexport const FromUrlForm = ({ onClose, onAddAsset, trackedLocation }: FromUrlFormProps) => {\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<Error | undefined>(undefined);\n  const { formatMessage } = useIntl();\n  const { trackUsage } = useTracking();\n\n  const handleSubmit = async ({ urls }: { urls: string }) => {\n    setLoading(true);\n    const urlArray = urls.split(/\\r?\\n/);\n    try {\n      const assets: FileWithRawFile[] = await urlsToAssets(urlArray);\n\n      if (trackedLocation) {\n        trackUsage('didSelectFile', { source: 'url', location: trackedLocation });\n      }\n\n      // no need to set the loading to false since the component unmounts\n      onAddAsset(assets);\n    } catch (e: unknown) {\n      setError(e as Error);\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Formik\n      enableReinitialize\n      initialValues={{\n        urls: '',\n      }}\n      onSubmit={handleSubmit}\n      validationSchema={urlSchema}\n      validateOnChange={false}\n    >\n      {({ values, errors, handleChange }) => (\n        <Form noValidate>\n          <Box paddingLeft={8} paddingRight={8} paddingBottom={6} paddingTop={6}>\n            <Field.Root\n              hint={formatMessage({\n                id: getTrad('input.url.description'),\n                defaultMessage: 'Separate your URL links by a carriage return.',\n              })}\n              error={\n                error?.message ||\n                (errors.urls\n                  ? formatMessage({ id: errors.urls, defaultMessage: 'An error occured' })\n                  : undefined)\n              }\n            >\n              <Field.Label>\n                {formatMessage({ id: getTrad('input.url.label'), defaultMessage: 'URL' })}\n              </Field.Label>\n              <Textarea name=\"urls\" onChange={handleChange} value={values.urls} />\n              <Field.Hint />\n              <Field.Error />\n            </Field.Root>\n          </Box>\n\n          <Modal.Footer>\n            <Button onClick={onClose} variant=\"tertiary\">\n              {formatMessage({ id: 'app.components.Button.cancel', defaultMessage: 'cancel' })}\n            </Button>\n            <Button type=\"submit\" loading={loading}>\n              {formatMessage({\n                id: getTrad('button.next'),\n                defaultMessage: 'Next',\n              })}\n            </Button>\n          </Modal.Footer>\n        </Form>\n      )}\n    </Formik>\n  );\n};\n"],"names":["FromUrlForm","onClose","onAddAsset","trackedLocation","loading","setLoading","React","useState","error","setError","undefined","formatMessage","useIntl","trackUsage","useTracking","handleSubmit","urls","urlArray","split","assets","urlsToAssets","source","location","e","_jsx","Formik","enableReinitialize","initialValues","onSubmit","validationSchema","urlSchema","validateOnChange","values","errors","handleChange","_jsxs","Form","noValidate","Box","paddingLeft","paddingRight","paddingBottom","paddingTop","Field","Root","hint","id","getTrad","defaultMessage","message","Label","Textarea","name","onChange","value","Hint","Error","Modal","Footer","Button","onClick","variant","type"],"mappings":"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"}