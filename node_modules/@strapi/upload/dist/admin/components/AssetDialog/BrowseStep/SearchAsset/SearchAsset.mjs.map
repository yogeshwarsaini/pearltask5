{"version":3,"file":"SearchAsset.mjs","sources":["../../../../../../admin/src/components/AssetDialog/BrowseStep/SearchAsset/SearchAsset.tsx"],"sourcesContent":["// TODO: find a better naming convention for the file that was an index file before\nimport * as React from 'react';\n\nimport { useTracking } from '@strapi/admin/strapi-admin';\nimport { IconButton, Searchbar, SearchForm } from '@strapi/design-system';\nimport { Search } from '@strapi/icons';\nimport { useIntl } from 'react-intl';\n\nimport { getTrad } from '../../../../utils';\n\nimport type { Query } from '../../../../../../shared/contracts/files';\n\ninterface SearchAssetProps {\n  onChangeSearch: (_q: Query['_q'] | null) => void;\n  queryValue?: Query['_q'] | null;\n}\n\nexport const SearchAsset = ({ onChangeSearch, queryValue = null }: SearchAssetProps) => {\n  const { formatMessage } = useIntl();\n  const { trackUsage } = useTracking();\n  const [isOpen, setIsOpen] = React.useState(!!queryValue);\n  const [value, setValue] = React.useState(queryValue || '');\n  const wrapperRef = React.useRef<HTMLDivElement>(null);\n\n  React.useLayoutEffect(() => {\n    if (isOpen) {\n      setTimeout(() => {\n        wrapperRef.current?.querySelector('input')?.focus();\n      }, 0);\n    }\n  }, [isOpen]);\n\n  const handleToggle = () => {\n    setIsOpen((prev) => !prev);\n  };\n\n  const handleClear = () => {\n    handleToggle();\n    onChangeSearch(null);\n  };\n\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    trackUsage('didSearchMediaLibraryElements', { location: 'content-manager' });\n    onChangeSearch(value);\n  };\n\n  if (isOpen) {\n    return (\n      <div ref={wrapperRef}>\n        <SearchForm onSubmit={handleSubmit}>\n          <Searchbar\n            name=\"search\"\n            onClear={handleClear}\n            onChange={(e) => setValue(e.target.value)}\n            clearLabel={formatMessage({\n              id: getTrad('search.clear.label'),\n              defaultMessage: 'Clear the search',\n            })}\n            aria-label=\"search\"\n            size=\"S\"\n            value={value}\n            placeholder={formatMessage({\n              id: getTrad('search.placeholder'),\n              defaultMessage: 'e.g: the first dog on the moon',\n            })}\n          >\n            {formatMessage({ id: getTrad('search.label'), defaultMessage: 'Search for an asset' })}\n          </Searchbar>\n        </SearchForm>\n      </div>\n    );\n  }\n\n  return (\n    <IconButton label=\"Search\" onClick={handleToggle}>\n      <Search />\n    </IconButton>\n  );\n};\n"],"names":["SearchAsset","onChangeSearch","queryValue","formatMessage","useIntl","trackUsage","useTracking","isOpen","setIsOpen","React","useState","value","setValue","wrapperRef","useRef","useLayoutEffect","setTimeout","current","querySelector","focus","handleToggle","prev","handleClear","handleSubmit","e","preventDefault","stopPropagation","location","_jsx","div","ref","SearchForm","onSubmit","Searchbar","name","onClear","onChange","target","clearLabel","id","getTrad","defaultMessage","aria-label","size","placeholder","IconButton","label","onClick","Search"],"mappings":";;;;;;;;;;;;;AAAA;AAiBO,MAAMA,cAAc,CAAC,EAAEC,cAAc,EAAEC,UAAAA,GAAa,IAAI,EAAoB,GAAA;IACjF,MAAM,EAAEC,aAAa,EAAE,GAAGC,OAAAA,EAAAA;IAC1B,MAAM,EAAEC,UAAU,EAAE,GAAGC,WAAAA,EAAAA;IACvB,MAAM,CAACC,QAAQC,SAAU,CAAA,GAAGC,MAAMC,QAAQ,CAAC,CAAC,CAACR,UAAAA,CAAAA;AAC7C,IAAA,MAAM,CAACS,KAAOC,EAAAA,QAAAA,CAAS,GAAGH,KAAMC,CAAAA,QAAQ,CAACR,UAAc,IAAA,EAAA,CAAA;IACvD,MAAMW,UAAAA,GAAaJ,KAAMK,CAAAA,MAAM,CAAiB,IAAA,CAAA;AAEhDL,IAAAA,KAAAA,CAAMM,eAAe,CAAC,IAAA;AACpB,QAAA,IAAIR,MAAQ,EAAA;YACVS,UAAW,CAAA,IAAA;gBACTH,UAAWI,CAAAA,OAAO,EAAEC,aAAAA,CAAc,OAAUC,CAAAA,EAAAA,KAAAA,EAAAA;aAC3C,EAAA,CAAA,CAAA;AACL;KACC,EAAA;AAACZ,QAAAA;AAAO,KAAA,CAAA;AAEX,IAAA,MAAMa,YAAe,GAAA,IAAA;QACnBZ,SAAU,CAAA,CAACa,OAAS,CAACA,IAAAA,CAAAA;AACvB,KAAA;AAEA,IAAA,MAAMC,WAAc,GAAA,IAAA;AAClBF,QAAAA,YAAAA,EAAAA;QACAnB,cAAe,CAAA,IAAA,CAAA;AACjB,KAAA;AAEA,IAAA,MAAMsB,eAAe,CAACC,CAAAA,GAAAA;AACpBA,QAAAA,CAAAA,CAAEC,cAAc,EAAA;AAChBD,QAAAA,CAAAA,CAAEE,eAAe,EAAA;AAEjBrB,QAAAA,UAAAA,CAAW,+BAAiC,EAAA;YAAEsB,QAAU,EAAA;AAAkB,SAAA,CAAA;QAC1E1B,cAAeU,CAAAA,KAAAA,CAAAA;AACjB,KAAA;AAEA,IAAA,IAAIJ,MAAQ,EAAA;AACV,QAAA,qBACEqB,GAACC,CAAAA,KAAAA,EAAAA;YAAIC,GAAKjB,EAAAA,UAAAA;AACR,YAAA,QAAA,gBAAAe,GAACG,CAAAA,UAAAA,EAAAA;gBAAWC,QAAUT,EAAAA,YAAAA;AACpB,gBAAA,QAAA,gBAAAK,GAACK,CAAAA,SAAAA,EAAAA;oBACCC,IAAK,EAAA,QAAA;oBACLC,OAASb,EAAAA,WAAAA;AACTc,oBAAAA,QAAAA,EAAU,CAACZ,CAAMZ,GAAAA,QAAAA,CAASY,CAAEa,CAAAA,MAAM,CAAC1B,KAAK,CAAA;AACxC2B,oBAAAA,UAAAA,EAAYnC,aAAc,CAAA;AACxBoC,wBAAAA,EAAAA,EAAIC,OAAQ,CAAA,oBAAA,CAAA;wBACZC,cAAgB,EAAA;AAClB,qBAAA,CAAA;oBACAC,YAAW,EAAA,QAAA;oBACXC,IAAK,EAAA,GAAA;oBACLhC,KAAOA,EAAAA,KAAAA;AACPiC,oBAAAA,WAAAA,EAAazC,aAAc,CAAA;AACzBoC,wBAAAA,EAAAA,EAAIC,OAAQ,CAAA,oBAAA,CAAA;wBACZC,cAAgB,EAAA;AAClB,qBAAA,CAAA;8BAECtC,aAAc,CAAA;AAAEoC,wBAAAA,EAAAA,EAAIC,OAAQ,CAAA,cAAA,CAAA;wBAAiBC,cAAgB,EAAA;AAAsB,qBAAA;;;;AAK9F;AAEA,IAAA,qBACEb,GAACiB,CAAAA,UAAAA,EAAAA;QAAWC,KAAM,EAAA,QAAA;QAASC,OAAS3B,EAAAA,YAAAA;AAClC,QAAA,QAAA,gBAAAQ,GAACoB,CAAAA,MAAAA,EAAAA,EAAAA;;AAGP;;;;"}