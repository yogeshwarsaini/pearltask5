{"version":3,"file":"view-configuration.js","sources":["../../../server/src/controllers/view-configuration.ts"],"sourcesContent":["import type { Context } from 'koa';\n\nimport { getService } from '../utils';\nimport { ACTIONS } from '../constants';\nimport { validateViewConfiguration } from './validation/admin/configureView';\n\nexport default {\n  async updateViewConfiguration(ctx: Context) {\n    const {\n      request: { body },\n      state: { userAbility },\n    } = ctx;\n\n    if (userAbility.cannot(ACTIONS.configureView)) {\n      return ctx.forbidden();\n    }\n\n    const data = await validateViewConfiguration(body);\n\n    await getService('upload').setConfiguration(data);\n\n    ctx.body = { data };\n  },\n\n  async findViewConfiguration(ctx: Context) {\n    const data = await getService('upload').getConfiguration();\n\n    ctx.body = { data };\n  },\n};\n"],"names":["updateViewConfiguration","ctx","request","body","state","userAbility","cannot","ACTIONS","configureView","forbidden","data","validateViewConfiguration","getService","setConfiguration","findViewConfiguration","getConfiguration"],"mappings":";;;;;;AAMA,wBAAe;AACb,IAAA,MAAMA,yBAAwBC,GAAY,EAAA;QACxC,MAAM,EACJC,OAAS,EAAA,EAAEC,IAAI,EAAE,EACjBC,KAAAA,EAAO,EAAEC,WAAW,EAAE,EACvB,GAAGJ,GAAAA;AAEJ,QAAA,IAAII,WAAYC,CAAAA,MAAM,CAACC,iBAAAA,CAAQC,aAAa,CAAG,EAAA;AAC7C,YAAA,OAAOP,IAAIQ,SAAS,EAAA;AACtB;QAEA,MAAMC,IAAAA,GAAO,MAAMC,uCAA0BR,CAAAA,IAAAA,CAAAA;QAE7C,MAAMS,gBAAAA,CAAW,QAAUC,CAAAA,CAAAA,gBAAgB,CAACH,IAAAA,CAAAA;AAE5CT,QAAAA,GAAAA,CAAIE,IAAI,GAAG;AAAEO,YAAAA;AAAK,SAAA;AACpB,KAAA;AAEA,IAAA,MAAMI,uBAAsBb,GAAY,EAAA;AACtC,QAAA,MAAMS,IAAO,GAAA,MAAME,gBAAW,CAAA,QAAA,CAAA,CAAUG,gBAAgB,EAAA;AAExDd,QAAAA,GAAAA,CAAIE,IAAI,GAAG;AAAEO,YAAAA;AAAK,SAAA;AACpB;AACF,CAAE;;;;"}