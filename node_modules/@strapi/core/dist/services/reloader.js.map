{"version":3,"file":"reloader.js","sources":["../../src/services/reloader.ts"],"sourcesContent":["import type { Core } from '@strapi/types';\n\nexport const createReloader = (strapi: Core.Strapi) => {\n  const state = {\n    shouldReload: 0,\n    isWatching: true,\n  };\n\n  function reload() {\n    if (state.shouldReload > 0) {\n      // Reset the reloading state\n      state.shouldReload -= 1;\n      reload.isReloading = false;\n      return;\n    }\n\n    if (strapi.config.get('autoReload')) {\n      process.send?.('reload');\n    }\n  }\n\n  Object.defineProperty(reload, 'isWatching', {\n    configurable: true,\n    enumerable: true,\n    set(value) {\n      // Special state when the reloader is disabled temporarly (see GraphQL plugin example).\n      if (state.isWatching === false && value === true) {\n        state.shouldReload += 1;\n      }\n      state.isWatching = value;\n    },\n    get() {\n      return state.isWatching;\n    },\n  });\n\n  reload.isReloading = false;\n  reload.isWatching = true;\n\n  return reload;\n};\n"],"names":["createReloader","strapi","state","shouldReload","isWatching","reload","isReloading","config","get","process","send","Object","defineProperty","configurable","enumerable","set","value"],"mappings":";;AAEO,MAAMA,iBAAiB,CAACC,MAAAA,GAAAA;AAC7B,IAAA,MAAMC,KAAQ,GAAA;QACZC,YAAc,EAAA,CAAA;QACdC,UAAY,EAAA;AACd,KAAA;IAEA,SAASC,MAAAA,GAAAA;QACP,IAAIH,KAAAA,CAAMC,YAAY,GAAG,CAAG,EAAA;;AAE1BD,YAAAA,KAAAA,CAAMC,YAAY,IAAI,CAAA;AACtBE,YAAAA,MAAAA,CAAOC,WAAW,GAAG,KAAA;AACrB,YAAA;AACF;AAEA,QAAA,IAAIL,MAAOM,CAAAA,MAAM,CAACC,GAAG,CAAC,YAAe,CAAA,EAAA;AACnCC,YAAAA,OAAAA,CAAQC,IAAI,GAAG,QAAA,CAAA;AACjB;AACF;IAEAC,MAAOC,CAAAA,cAAc,CAACP,MAAAA,EAAQ,YAAc,EAAA;QAC1CQ,YAAc,EAAA,IAAA;QACdC,UAAY,EAAA,IAAA;AACZC,QAAAA,GAAAA,CAAAA,CAAIC,KAAK,EAAA;;AAEP,YAAA,IAAId,KAAME,CAAAA,UAAU,KAAK,KAAA,IAASY,UAAU,IAAM,EAAA;AAChDd,gBAAAA,KAAAA,CAAMC,YAAY,IAAI,CAAA;AACxB;AACAD,YAAAA,KAAAA,CAAME,UAAU,GAAGY,KAAAA;AACrB,SAAA;AACAR,QAAAA,GAAAA,CAAAA,GAAAA;AACE,YAAA,OAAON,MAAME,UAAU;AACzB;AACF,KAAA,CAAA;AAEAC,IAAAA,MAAAA,CAAOC,WAAW,GAAG,KAAA;AACrBD,IAAAA,MAAAA,CAAOD,UAAU,GAAG,IAAA;IAEpB,OAAOC,MAAAA;AACT;;;;"}