{"version":3,"file":"EntryValidationPopover.mjs","sources":["../../../admin/src/components/EntryValidationPopover.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { FormErrors, FormValues } from '@strapi/admin/strapi-admin';\nimport { unstable_useDocument } from '@strapi/content-manager/strapi-admin';\nimport { Button, LinkButton, Flex, Typography, Popover } from '@strapi/design-system';\nimport { CheckCircle, CrossCircle, ArrowsCounterClockwise, CaretDown } from '@strapi/icons';\nimport { stringify } from 'qs';\nimport { useIntl, MessageDescriptor } from 'react-intl';\nimport { Link } from 'react-router-dom';\nimport { styled } from 'styled-components';\n\nimport type {\n  ReleaseAction,\n  ReleaseActionEntry,\n  Stage,\n} from '../../../shared/contracts/release-actions';\nimport type { Struct } from '@strapi/types';\n\nconst StyledPopoverFlex = styled(Flex)`\n  width: 100%;\n  max-width: 256px;\n\n  & > * {\n    border-bottom: 1px solid ${({ theme }) => theme.colors.neutral150};\n  }\n\n  & > *:last-child {\n    border-bottom: none;\n  }\n`;\n\ninterface EntryValidationPopoverProps {\n  action: ReleaseAction['type'];\n  schema?: Struct.ContentTypeSchema & {\n    hasReviewWorkflow: boolean;\n    stageRequiredToPublish?: Stage;\n  };\n  entry: ReleaseActionEntry;\n  status: ReleaseAction['status'];\n}\n\ninterface ValidationStatusProps {\n  action: ReleaseAction['type'];\n  status: ReleaseAction['status'];\n  hasErrors: boolean | null;\n  requiredStage?: Stage;\n  entryStage?: Stage;\n}\n\nconst EntryStatusTrigger = ({\n  action,\n  status,\n  hasErrors,\n  requiredStage,\n  entryStage,\n}: ValidationStatusProps) => {\n  const { formatMessage } = useIntl();\n\n  if (action === 'publish') {\n    if (hasErrors || (requiredStage && requiredStage.id !== entryStage?.id)) {\n      return (\n        <Popover.Trigger>\n          <Button\n            variant=\"ghost\"\n            startIcon={<CrossCircle fill=\"danger600\" />}\n            endIcon={<CaretDown />}\n          >\n            <Typography textColor=\"danger600\" variant=\"omega\" fontWeight=\"bold\">\n              {formatMessage({\n                id: 'content-releases.pages.ReleaseDetails.entry-validation.not-ready',\n                defaultMessage: 'Not ready to publish',\n              })}\n            </Typography>\n          </Button>\n        </Popover.Trigger>\n      );\n    }\n\n    if (status === 'draft') {\n      return (\n        <Popover.Trigger>\n          <Button\n            variant=\"ghost\"\n            startIcon={<CheckCircle fill=\"success600\" />}\n            endIcon={<CaretDown />}\n          >\n            <Typography textColor=\"success600\" variant=\"omega\" fontWeight=\"bold\">\n              {formatMessage({\n                id: 'content-releases.pages.ReleaseDetails.entry-validation.ready-to-publish',\n                defaultMessage: 'Ready to publish',\n              })}\n            </Typography>\n          </Button>\n        </Popover.Trigger>\n      );\n    }\n\n    if (status === 'modified') {\n      return (\n        <Popover.Trigger>\n          <Button\n            variant=\"ghost\"\n            startIcon={<ArrowsCounterClockwise fill=\"alternative600\" />}\n            endIcon={<CaretDown />}\n          >\n            <Typography variant=\"omega\" fontWeight=\"bold\" textColor=\"alternative600\">\n              {formatMessage({\n                id: 'content-releases.pages.ReleaseDetails.entry-validation.modified',\n                defaultMessage: 'Ready to publish changes',\n              })}\n            </Typography>\n          </Button>\n        </Popover.Trigger>\n      );\n    }\n\n    return (\n      <Popover.Trigger>\n        <Button\n          variant=\"ghost\"\n          startIcon={<CheckCircle fill=\"success600\" />}\n          endIcon={<CaretDown />}\n        >\n          <Typography textColor=\"success600\" variant=\"omega\" fontWeight=\"bold\">\n            {formatMessage({\n              id: 'content-releases.pages.ReleaseDetails.entry-validation.already-published',\n              defaultMessage: 'Already published',\n            })}\n          </Typography>\n        </Button>\n      </Popover.Trigger>\n    );\n  }\n\n  if (status === 'published') {\n    return (\n      <Popover.Trigger>\n        <Button\n          variant=\"ghost\"\n          startIcon={<CheckCircle fill=\"success600\" />}\n          endIcon={<CaretDown />}\n        >\n          <Typography textColor=\"success600\" variant=\"omega\" fontWeight=\"bold\">\n            {formatMessage({\n              id: 'content-releases.pages.ReleaseDetails.entry-validation.ready-to-unpublish',\n              defaultMessage: 'Ready to unpublish',\n            })}\n          </Typography>\n        </Button>\n      </Popover.Trigger>\n    );\n  }\n\n  return (\n    <Popover.Trigger>\n      <Button variant=\"ghost\" startIcon={<CheckCircle fill=\"success600\" />} endIcon={<CaretDown />}>\n        <Typography textColor=\"success600\" variant=\"omega\" fontWeight=\"bold\">\n          {formatMessage({\n            id: 'content-releases.pages.ReleaseDetails.entry-validation.already-unpublished',\n            defaultMessage: 'Already unpublished',\n          })}\n        </Typography>\n      </Button>\n    </Popover.Trigger>\n  );\n};\n\ninterface FieldsValidationProps {\n  hasErrors: boolean;\n  errors: FormErrors<FormValues> | null;\n  kind?: string;\n  contentTypeUid?: string;\n  documentId?: string;\n  locale?: string;\n}\n\nconst FieldsValidation = ({\n  hasErrors,\n  errors,\n  kind,\n  contentTypeUid,\n  documentId,\n  locale,\n}: FieldsValidationProps) => {\n  const { formatMessage } = useIntl();\n\n  return (\n    <Flex direction=\"column\" gap={1} width=\"100%\" padding={5}>\n      <Flex gap={2} width=\"100%\">\n        <Typography fontWeight=\"bold\">\n          {formatMessage({\n            id: 'content-releases.pages.ReleaseDetails.entry-validation.fields',\n            defaultMessage: 'Fields',\n          })}\n        </Typography>\n        {hasErrors ? <CrossCircle fill=\"danger600\" /> : <CheckCircle fill=\"success600\" />}\n      </Flex>\n      <Typography width=\"100%\" textColor=\"neutral600\">\n        {hasErrors\n          ? formatMessage(\n              {\n                id: 'content-releases.pages.ReleaseDetails.entry-validation.fields.error',\n                defaultMessage: '{errors} errors on fields.',\n              },\n              { errors: errors ? Object.keys(errors).length : 0 }\n            )\n          : formatMessage({\n              id: 'content-releases.pages.ReleaseDetails.entry-validation.fields.success',\n              defaultMessage: 'All fields are filled correctly.',\n            })}\n      </Typography>\n      {hasErrors && (\n        <LinkButton\n          tag={Link}\n          to={{\n            pathname: `/content-manager/${kind === 'collectionType' ? 'collection-types' : 'single-types'}/${contentTypeUid}/${documentId}`,\n            search: locale\n              ? stringify({\n                  plugins: {\n                    i18n: {\n                      locale,\n                    },\n                  },\n                })\n              : '',\n          }}\n          variant=\"secondary\"\n          fullWidth\n          state={{ forceValidation: true }}\n        >\n          {formatMessage({\n            id: 'content-releases.pages.ReleaseDetails.entry-validation.fields.see-errors',\n            defaultMessage: 'See errors',\n          })}\n        </LinkButton>\n      )}\n    </Flex>\n  );\n};\n\nconst getReviewStageIcon = ({\n  contentTypeHasReviewWorkflow,\n  requiredStage,\n  entryStage,\n}: {\n  contentTypeHasReviewWorkflow: boolean;\n  requiredStage?: Stage;\n  entryStage?: Stage;\n}) => {\n  if (!contentTypeHasReviewWorkflow) {\n    return <CheckCircle fill=\"neutral200\" />;\n  }\n  if (requiredStage && requiredStage.id !== entryStage?.id) {\n    return <CrossCircle fill=\"danger600\" />;\n  }\n  return <CheckCircle fill=\"success600\" />;\n};\n\nconst getReviewStageMessage = ({\n  contentTypeHasReviewWorkflow,\n  requiredStage,\n  entryStage,\n  formatMessage,\n}: {\n  contentTypeHasReviewWorkflow: boolean;\n  requiredStage?: Stage;\n  entryStage?: Stage;\n  formatMessage: (messageDescriptor: MessageDescriptor, values?: Record<string, string>) => string;\n}) => {\n  if (!contentTypeHasReviewWorkflow) {\n    return formatMessage({\n      id: 'content-releases.pages.ReleaseDetails.entry-validation.review-stage.not-enabled',\n      defaultMessage: 'This entry is not associated to any workflow.',\n    });\n  }\n\n  if (requiredStage && requiredStage.id !== entryStage?.id) {\n    return formatMessage(\n      {\n        id: 'content-releases.pages.ReleaseDetails.entry-validation.review-stage.not-ready',\n        defaultMessage: 'This entry is not at the required stage for publishing. ({stageName})',\n      },\n      {\n        stageName: requiredStage?.name ?? '',\n      }\n    );\n  }\n\n  if (requiredStage && requiredStage.id === entryStage?.id) {\n    return formatMessage(\n      {\n        id: 'content-releases.pages.ReleaseDetails.entry-validation.review-stage.ready',\n        defaultMessage: 'This entry is at the required stage for publishing. ({stageName})',\n      },\n      {\n        stageName: requiredStage?.name ?? '',\n      }\n    );\n  }\n\n  return formatMessage({\n    id: 'content-releases.pages.ReleaseDetails.entry-validation.review-stage.stage-not-required',\n    defaultMessage: 'No required stage for publication',\n  });\n};\n\nconst ReviewStageValidation = ({\n  contentTypeHasReviewWorkflow,\n  requiredStage,\n  entryStage,\n}: {\n  contentTypeHasReviewWorkflow: boolean;\n  requiredStage?: Stage;\n  entryStage?: Stage;\n}) => {\n  const { formatMessage } = useIntl();\n\n  const Icon = getReviewStageIcon({\n    contentTypeHasReviewWorkflow,\n    requiredStage,\n    entryStage,\n  });\n\n  return (\n    <Flex direction=\"column\" gap={1} width=\"100%\" padding={5}>\n      <Flex gap={2} width=\"100%\">\n        <Typography fontWeight=\"bold\">\n          {formatMessage({\n            id: 'content-releases.pages.ReleaseDetails.entry-validation.review-stage',\n            defaultMessage: 'Review stage',\n          })}\n        </Typography>\n        {Icon}\n      </Flex>\n      <Typography textColor=\"neutral600\">\n        {getReviewStageMessage({\n          contentTypeHasReviewWorkflow,\n          requiredStage,\n          entryStage,\n          formatMessage,\n        })}\n      </Typography>\n    </Flex>\n  );\n};\n\nexport const EntryValidationPopover = ({\n  schema,\n  entry,\n  status,\n  action,\n}: EntryValidationPopoverProps) => {\n  const { validate, isLoading } = unstable_useDocument(\n    {\n      collectionType: schema?.kind ?? '',\n      model: schema?.uid ?? '',\n    },\n    {\n      // useDocument makes a request to get more data about the entry, but we only want to have the validation function so we skip the request\n      skip: true,\n    }\n  );\n\n  // Validation errors\n  const errors = isLoading ? null : validate(entry);\n  const hasErrors = errors ? Object.keys(errors).length > 0 : false;\n\n  // Entry stage\n  const contentTypeHasReviewWorkflow = schema?.hasReviewWorkflow ?? false;\n  const requiredStage = schema?.stageRequiredToPublish;\n  const entryStage = entry.strapi_stage;\n\n  if (isLoading) {\n    return null;\n  }\n\n  return (\n    <Popover.Root>\n      <EntryStatusTrigger\n        action={action}\n        status={status}\n        hasErrors={hasErrors}\n        requiredStage={requiredStage}\n        entryStage={entryStage}\n      />\n      <Popover.Content>\n        <StyledPopoverFlex direction=\"column\">\n          <FieldsValidation\n            hasErrors={hasErrors}\n            errors={errors}\n            contentTypeUid={schema?.uid}\n            kind={schema?.kind}\n            documentId={entry.documentId}\n            locale={entry.locale}\n          />\n          <ReviewStageValidation\n            contentTypeHasReviewWorkflow={contentTypeHasReviewWorkflow}\n            requiredStage={requiredStage}\n            entryStage={entryStage}\n          />\n        </StyledPopoverFlex>\n      </Popover.Content>\n    </Popover.Root>\n  );\n};\n"],"names":["StyledPopoverFlex","styled","Flex","theme","colors","neutral150","EntryStatusTrigger","action","status","hasErrors","requiredStage","entryStage","formatMessage","useIntl","id","_jsx","Popover","Trigger","Button","variant","startIcon","CrossCircle","fill","endIcon","CaretDown","Typography","textColor","fontWeight","defaultMessage","CheckCircle","ArrowsCounterClockwise","FieldsValidation","errors","kind","contentTypeUid","documentId","locale","_jsxs","direction","gap","width","padding","Object","keys","length","LinkButton","tag","Link","to","pathname","search","stringify","plugins","i18n","fullWidth","state","forceValidation","getReviewStageIcon","contentTypeHasReviewWorkflow","getReviewStageMessage","stageName","name","ReviewStageValidation","Icon","EntryValidationPopover","schema","entry","validate","isLoading","unstable_useDocument","collectionType","model","uid","skip","hasReviewWorkflow","stageRequiredToPublish","strapi_stage","Root","Content"],"mappings":"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"}